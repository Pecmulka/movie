<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>КиноРецензии</title>
    <!-- UIkit CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.16.0/dist/css/uikit.min.css">
    <style>

    </style>
</head>
<body>
    <!-- Шапка сайта -->
    <header class="uk-header, uk-background-secondary">
        <div class="uk-container">
            <nav class="uk-navbar-container uk-navbar-transparent" uk-navbar>
                <div class="uk-navbar-left">
                    <!-- Логотип -->
                    <a class="uk-navbar-item logo" href="/">
                        <span>КиноРецензии</span>
                    </a>
                </div>
            </nav>
        </div>
    </header>

    {% block content %}
    <div class="uk-card uk-card-default">
        <div class="uk-card-header">
            <h1 class="uk-card-title uk-margin-remove-bottom">{{ movie.name }} ({{ movie.year }})</h1>

            <div class="uk-text-meta uk-margin-small-top">
                Жанры:
                {% for genre in movie.genres.all %}
                    <span class="uk-badge">{{ genre.name }}</span>
                {% endfor %}
            </div>

           <div class="uk-margin-small-top">
                <span class="uk-label uk-label-success">
                    ★ Средняя оценка: {{ movie.average_rating }}/10
                </span>
                <span class="uk-label uk-label-primary uk-margin-small-left">
                    {{ movie.review_count }} отзывов
                </span>
            </div>
        </div>

        <div class="uk-card-body">
            {% if movie.description %}
            <p>{{ movie.description }}</p>
            {% endif %}

            <h3>Отзывы</h3>

            {% for review in movie.review_set.all %}
            <div class="uk-comment uk-comment-primary uk-margin-bottom">
                <header class="uk-comment-header">
                    <div class="uk-grid-medium uk-flex-middle" uk-grid>
                        <div class="uk-width-auto">
                            <a href="{% url 'reviewer_detail' review.reviewer.id %}">
                                <span class="uk-comment-avatar" uk-icon="icon: user; ratio: 2"></span>
                            </a>
                        </div>
                        <div class="uk-width-expand">
                            <h4 class="uk-comment-title uk-margin-remove">
                                <a href="{% url 'reviewer_detail' review.reviewer.id %}" class="uk-link-heading">
                                    {{ review.reviewer.name }}
                                </a>
                            </h4>
                            <ul class="uk-comment-meta uk-subnav uk-subnav-divider uk-margin-remove-top">
                                <li>★ {{ review.rating }}/10</li>
                                <li>{{ review.published_at|date:"d.m.Y H:i" }}</li>
                            </ul>
                        </div>
                    </div>
                </header>
                <div class="uk-comment-body">
                    <p>{{ review.text }}</p>
                </div>
            </div>
            {% empty %}
            <p class="uk-text-muted">Пока нет отзывов для этого фильма.</p>
            {% endfor %}
        </div>
    </div>
    {% endblock %}
</body>